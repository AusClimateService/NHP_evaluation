#!/bin/bash

#PBS -q normal
#PBS -P er4
#PBS -N xxJOB_NAMExx
#PBS -l walltime=24:00:00
#PBS -l ncpus=2
#PBS -l mem=12gb
#PBS -l wd
#PBS -l storage=gdata/er4+scratch/er4
#PBS -o xxJOB_OUTPUT_FILExx
#PBS -e xxJOB_ERROR_FILExx


var_ref=xxVARxx
gcm=xxGCMxx
timescale=xxTIMESCALExx
statistic=xxSTATISTICxx

case ${var_ref} in
    rain_day)
        var_sim=pr
        unit_conv_factor=86400
        unit_conv_add=0
        ;;
    solar_exposure_day)
        var_sim=rsds
        unit_conv_factor=0.0864
        unit_conv_add=0
        ;;
    temp_max_day)
        var_sim=tasmax
        unit_conv_factor=1
        unit_conv_add=-273.15
        ;;
    temp_min_day)
        var_sim=tasmin
        unit_conv_factor=1
        unit_conv_add=-273.15
        ;;
    wind)
        var_sim=sfcWind
        unit_conv_factor=1
        unit_conv_add=0
        ;;
esac

# if statistic == 'std' then no additive unit conversion needed (only multiplicative)
case ${statistic} in
    std)    unit_conv_add=0
        ;;
esac

ref_start_year="1976"
ref_end_year="2005"
path_climate_data="/scratch/er4/HYDROPROJ/ISIMIP_data/processed/annual_files/${gcm}/historical"
path_statistics_ref="/scratch/er4/${USER}/hydro_projections/data/evaluation/AWAP"
out_path="/scratch/er4/${USER}/hydro_projections/data/evaluation/ISIMIP_AWAP/climate_inputs/${gcm}"
name_sim="isimip_${gcm}"
name_ref="awap"


sh evaluation_scores_climate_input.sh ${var_sim} ${var_ref} ${ref_start_year} ${ref_end_year} ${path_climate_data} ${path_statistics_ref} ${out_path} ${timescale} ${statistic} ${name_sim} ${name_ref} ${unit_conv_factor} ${unit_conv_add}

wait

